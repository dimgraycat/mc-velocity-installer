# コーディングルール

本ドキュメントは、本リポジトリでのRust開発における共通ルールをまとめたものです。

## 関連ドキュメント

- リポジトリ全体の仕様・運用: `docs/README.md`

## 必須の検証

以下は必須です。作業前後・PR作成前に必ず実行してください。

```bash
cargo fmt
cargo clippy --all-targets --all-features -- -D warnings
```

rust-analyzer はエディタ統合での解析が必須です。未設定の場合は導入してください。

## フォーマット

- 公式の rustfmt に従う
- 手動整形はしない（`cargo fmt` を優先）

## リンティング

- clippy の警告はすべて解消する
- 例外を許可する場合は、理由をコメントで明記する

## 命名

- 変数・関数: `snake_case`
- 型・構造体・列挙体: `PascalCase`
- 定数: `SCREAMING_SNAKE_CASE`
- 省略語は一貫性を保つ（例: `config`, `cfg` のどちらかに統一）

## エラーハンドリング

- `Result` を返す関数では `?` を優先して伝播する
- `unwrap`/`expect` はテスト・明確に安全と判断できる箇所のみ
- エラーメッセージは利用者に有用な情報を含める

## 設計・実装

- 小さな関数に分割し、単一責務を意識する
- 不要な `clone` を避け、所有権・借用を意識する
- 公開APIは最小限にする（`pub` を慎重に）
- 重要な分岐や安全性の根拠が分かりにくい場合は短いコメントを入れる

## テスト

- 変更により動作が変わる場合はテスト追加を検討する
- 可能であれば `cargo test` を実行する
